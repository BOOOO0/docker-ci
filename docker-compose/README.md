# 도커 컴포즈로 node.js 서버, 레디스 서버 실행하기

- `docker-compose`는 여러개의 도커 컨테이너를 실행할 수 있는 툴입니다.

- node.js 서버에서 레디스를 사용하려면 레디스 서버를 실행한 후 레디스 관련 모듈을 node.js 앱에 설치하고 레디스 클라이언트를 실행시켜야 합니다.

## 도커 환경일 때와 도커 환경이 아닐 때 레디스 호스트 인자의 표현 차이

- 일반적으로 레디스 서버를 사용할 때는 `https://redis-server.com`으로 URL을 사용하지만 도커 환경에서는 레디스 서버가 컨테이너로서 작동하기 때문에 docker-compose.yml에 명시한 컨테이너의 이름으로 인자를 전달합니다.

## yaml

- yml 파일은 XML이나 json 포맷 보다 사람이 읽기 쉬운 포맷으로 작성한 데이터 포맷이고 도커 컴포즈 파일은 yml 파일로 작성합니다.

## 도커 컴포즈 파일 구조

- version은 도커 컴포즈의 버전을 의미합니다. services는 실행할 컨테이너들을 정의하는 부분입니다.

- services의 하위 항목으로 작성할 실행될 컨테이너는 도커 라이브러리에 존재하는 이미지를 사용할 때와 직접 빌드한 이미지를 사용할 때 작성 방식이 다릅니다.

- 라이브러리에 존재하는 이미지는 이미지의 이름을 명시합니다.

- 직접 빌드하는 이미지는 빌드의 경로를 명시하고 컨테이너에 할당할 포트를 명시합니다.

## 도커 컴포즈로 다중 컨테이너 실행

- 실행을 할 땐 도커 컴포즈 파일이 있는 경로에서 `docker-compose up` 명령어를 사용할 수 있습니다.

- 도커 컴포즈로 실행한 컨테이너를 동시에 종료시키려면 `docker-compose down` 명령어를 사용할 수 있습니다.

## 도커 컴포즈 파일에 도커 볼륨 적용

- 도커 볼륨을 적용할 앱의 `volumes` 항목에 도커 볼륨에 사용할 경로를 명시하면 새로 빌드하지 않고 도커 컴포즈로 재실행만 하면 소스 파일의 변경 사항을 적용시킬 수 있습니다.
